<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <style type="text/css">
  body {
  	max-width: 20cm;
  	margin-left: auto;
  	margin-right: auto;
  	text-align: justify;
  }
  @media screen {
  	body {
  		font-family: sans;
  	}
  }
  @media print {
  	body {
  		font-family: serif;
  	}
  }
  
  h1, h2, h3, h4, h5, h6 {
  	font-family: sans;
  }
  
  h1 {
  	text-align: center;
  	border-bottom: 2px solid gray;
  }
  
  h2 {
  	margin-top: 1cm;
  	border-bottom: 2px dotted gray;
  }
  
  blockquote {
  	background-color: #fbfbfb;
  	padding: 0.3cm;
  	border-radius: 0.2cm;
  	border-color: blue;
  	border-style: solid;
  	border-width: 2px;
  	margin-left: 0;
  	margin-right: 0;
  	font-style: italic;
  }
  
  
  pre.sourceCode {
  	background-color: #fbfbfb;
  	padding: 0.3cm;
  	border-radius: 0.2cm;
  	border-color: green;
  	border-style: solid;
  	border-width: 2px;
  }
  
  a.footnoteRef {
  	text-decoration: none;
  	color: blue;
  }
  
  figure > img {
  	width: 100%;
  	height: auto;
  }
  
  section.license {
  	font-size: 60%;
  	color: gray;
  }
  
  section.license > a {
  	color: gray;
  }
  
  </style>
</head>
<body>
<h1 id="class-templates">Class-Templates</h1>
<p>In the last chapter we created a struct for Cartesian points:</p>
<pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="ot">#include &lt;iostream&gt;</span>

<span class="kw">struct</span> point {
	point(<span class="dt">double</span> x, <span class="dt">double</span> y, <span class="dt">double</span> z) : x{x}, y{y}, z{z} 
	{}

	<span class="dt">double</span> x = <span class="fl">0.</span><span class="dv">0</span>;
	<span class="dt">double</span> y = <span class="fl">0.</span><span class="dv">0</span>;
	<span class="dt">double</span> z = <span class="fl">0.</span><span class="dv">0</span>;
};

<span class="dt">int</span> main() {
	point p{<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>};
	std::cout &lt;&lt; <span class="st">&quot;p: &quot;</span> &lt;&lt; p.x &lt;&lt; <span class="st">&#39;/&#39;</span> &lt;&lt; p.y &lt;&lt; <span class="st">&#39;/&#39;</span> &lt;&lt; p.z &lt;&lt; <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>;
}</code></pre>
<pre><code>&gt;&gt; p: 1/2/3</code></pre>
<p>This still works great, but their is one problem: What should we do, if we want a point that only consists of integral coordinates? Or with floats instead of doubles? Or with complex numbers?</p>
<p>The obvious and bad solution would be to create one struct for each and give them different names like “<code>point_f</code>”, “<code>point_i</code>” and so on. This is repetitive, boring, error-prone and therefore hard to maintain. Especially since the only difference in these structs will be type of the values.</p>
<p>To solve this problem C++ has so called class-templates (they work with structs too). So if we want a point-class for every type T, we can just write this:</p>
<pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="ot">#include &lt;iostream&gt;</span>

<span class="kw">template</span>&lt;<span class="kw">typename</span> T&gt;
<span class="kw">struct</span> point {
	<span class="co">// use const-references because T might be a &#39;heavy&#39; type:</span>
	point(<span class="dt">const</span> T&amp; x, <span class="dt">const</span> T&amp; y, <span class="dt">const</span> T&amp; z) : x{x}, y{y}, z{z} {}
	
	T x = <span class="dv">0</span>;
	T y = <span class="dv">0</span>;
	T z = <span class="dv">0</span>;
};

<span class="dt">int</span> main()
{
	point&lt;<span class="dt">int</span>&gt; p_int{<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>};
	std::cout &lt;&lt; <span class="st">&quot;p_int: &quot;</span> &lt;&lt; p_int.x &lt;&lt; <span class="st">&#39;/&#39;</span> &lt;&lt; p_int.y &lt;&lt; <span class="st">&#39;/&#39;</span> &lt;&lt; p_int.z &lt;&lt; <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>;
	
	point&lt;<span class="dt">float</span>&gt; p_float{<span class="fl">1.</span><span class="dv">5</span>,<span class="fl">2.</span><span class="dv">3</span>,<span class="fl">3.</span><span class="dv">2</span>};
	std::cout &lt;&lt; <span class="st">&quot;p_float: &quot;</span> &lt;&lt; p_float.x &lt;&lt; <span class="st">&#39;/&#39;</span> &lt;&lt; p_float.y &lt;&lt; <span class="st">&#39;/&#39;</span> &lt;&lt; p_float.z &lt;&lt; <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>;
}</code></pre>
<pre><code>&gt;&gt; p_int: 1/2/3
&gt;&gt; p_float: 1.5/2.3/3.2</code></pre>
<p>This is not really different from writing normal functions so far, so let's see how we can create methods.</p>
<p>If we implement the method directly in the class, there is no difference at all. If we want to implement it outside of the class, there are two small changes:</p>
<ul>
<li>Instead of <code>foo::bar()</code> we have to write <code>template&lt;typename T&gt; foo&lt;T&gt;::bar()</code> in the signature, since there is now more than one class called foo.</li>
<li>The implementation must be available to every user (and since not be put into another file). Since we haven't yet grown out of just using one file, this is currently no big deal.</li>
</ul>
<p>Let's see an example:</p>
<pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="ot">#include &lt;iostream&gt;</span>

<span class="kw">template</span>&lt;<span class="kw">typename</span> T&gt;
<span class="kw">struct</span> point {
	point(<span class="dt">const</span> T&amp; x, <span class="dt">const</span> T&amp; y, <span class="dt">const</span> T&amp; z) : x{x}, y{y}, z{z} {}
	
	T x = <span class="dv">0</span>;
	T y = <span class="dv">0</span>;
	T z = <span class="dv">0</span>;
	
	<span class="co">//definition in class-template:</span>
	<span class="dt">void</span> print() {
		std::cout &lt;&lt; x &lt;&lt; <span class="st">&#39;/&#39;</span> &lt;&lt; y &lt;&lt; <span class="st">&#39;/&#39;</span> &lt;&lt; z &lt;&lt; <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>;
	}
	
	<span class="co">// definiton outside</span>
	<span class="dt">void</span> reset();
};

<span class="kw">template</span>&lt;<span class="kw">typename</span> T&gt;
<span class="dt">void</span> point&lt;T&gt;::reset() {
	x = <span class="dv">0</span>;
	y = <span class="dv">0</span>;
	z = <span class="dv">0</span>;
}

<span class="dt">int</span> main() {
	point&lt;<span class="dt">int</span>&gt; p{<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>};
	p.print();
	p.reset();
	p.print();
}</code></pre>
<pre><code>&gt;&gt; 1/2/3
&gt;&gt; 0/0/0</code></pre>
<p>That is basically it. There really shouldn't be any surprises so far. We will learn more about this mechanism in the future, for example how we can create special versions for certain instantiations and why this mechanism is way more powerfull than it currently appears.</p>
<hr/>
<section class="license">
	<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
		<img src="CC_BY_SA.png" height="31px" width="88px" alt="CC-BY-SA" align="left" hspace="2px"/>
	</a>
	This work from Florian Weber is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.<br/>
	Dieses Werk von Florian Weber ist lizenziert unter einer <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.de">Creative Commons Namensnennung - Weitergabe unter gleichen Bedingungen 4.0 International Lizenz</a>
</section>
</body>
</html>
